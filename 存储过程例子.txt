create or replace procedure pro_msg(out_msg out sys_refcursor ,success out number) is
       m_id number;
       m_name varchar(200);
       m_creator varchar(200);
       m_isvalid number;

begin
       success :=1;
             
       open out_msg for 
            select t.id,t.name ,t.creator,t.isvalid from RSCH_MSG_GROUP t;
			
			
	   if fjjzz_p!=0 then
	   open out_asset for
       select fjjmc_p as v_jjmc, fjjdm_i as v_jjdm,
       round(fcash_p/fjjzz_p*100, 2) as n_cash_ratio, round(fflow_asset_p/fjjzz_p, 2) as n_flow_asset_ratio,
       round(funliquidity_asset_p/fjjzz_p, 2) as n_unliquidity_asset_ratio,
       round(fleft_day_p, 2) as n_left_day,
       round(fjjzz_p*0.1 - f3a_asset_p, 2) as n_left_3aasset
       from dual;
       else
       open out_asset for
       select fjjmc_p as v_jjmc, fjjdm_i as v_jjdm,
       0 as n_cash_ratio, 0 as n_flow_asset_ratio,
       0 as n_unliquidity_asset_ratio,
       round(fleft_day_p, 2) as n_left_day,
       0 as n_left_3aasset
       from dual;
       end if;
            
       success :=0;
       
       exception when others then
       DBMS_OUTPUT.put_line(sqlcode);    
       DBMS_OUTPUT.put_line(sqlerrm);
       
       rollback;
       
end pro_msg;


